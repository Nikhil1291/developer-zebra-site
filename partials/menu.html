<aside class="tree-sidebar">            

            <div class="row">
                <div class="col-sm-12">

                    <div class="sidebar-container" >
                        <!-- <ul  class="" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> -->
                        <ul  class="">
                            {{#if this.menu.title}}
                            <li>
                                  {{#if this.menu.img}}<img src="{{this.menu.img}}" alt="logo" style="max-height:42px" class="img-responsive"> 
                                  {{/if}}
                                  <strong>{{this.menu.title}}</strong>
                            </li>
                            {{/if}}
                        {{#each this.menu.items}}
                            <li class="">
                                {{#if this.items}}
                                <span class="arrow"></span>
                                {{/if}}
                                {{#if this.url}}
                                <a href="{{this.url}}">
                                {{else}}
                                <a>
                                {{/if}}
                                <span class="arrow-li">{{this.title}}</span>
                                </a> 
                                {{#if this.items}}
                                    <ul style="">
                                    {{#each this.items}}
                                        <li>
                                            {{#if this.items}}
                                            <span class="arrow"></span>
                                            {{/if}}
                                            {{#if this.url}}
                                            <a href="{{this.url}}">
                                            {{else}}
                                            <a>
                                            {{/if}}
                                            <span class="arrow-li">{{this.title}}</span>
                                            </a> 
                                            {{#if this.items}}
                                                <ul >
                                                {{#each this.items}}
                                                    <li>
                                                    <a href="{{this.url}}"><span>{{this.title}}</span></a>
                                                    </li>
                                                {{/each}}                        
                                                </ul>
                                            {{/if}}
                                        </li>
                                    {{/each}}                        
                                    </ul>
                                {{/if}}
                            </li>
                        {{/each}}
                        </ul>
                    </div>
                </div>
            </div>
</aside>

<script type="text/javascript">
    $(window).load(function() {
        var pathname = window.location.pathname.slice(0, -1);
        // console.log(pathname);
        var menuitem = $('.sidebar-container').find('a[href^="' + pathname + '"]').first()[0];
        var menulevel = $(menuitem).parents('ul').length;
        // console.log(menuitem);
        // console.log(menulevel);
        var parentLI = $(menuitem).parent().parent().parent();
        var itemarrow = parentLI.find('.arrow').first()[0];

        //now check for higher level
        if(menulevel==3){

            var parentFirstLevel = $(parentLI).parent().parent().first()[0];
            var parentarrow = $(parentFirstLevel).find('.arrow').first()[0];
            parentarrow.click();
        }

        if(menulevel>1){
            itemarrow.click();

        }
        $(menuitem).addClass('sidebar-selected');
        $(menuitem).parent().append('<ul style="display:block" id="indoc"></ul>')
        $('h2').each(function(index, value){
              if($(this).attr('id')){
                var anchor = "#" + $(this).attr('id');
                var text = $(this).text();
                var li = "<li><a href='" + anchor + "'>" + text + "</a>" ;
                $('#indoc').append(li);               
              }

              
        });
    });

    function affix() {
        
        // Fit affix width to its parent's width
        var $affixElement = $('div[data-spy="affix"]');
        $affixElement.width($affixElement.parent().width());
 
        // Position of vertical scrollbar 
        var position = $(window).scrollTop();
        if (position >= offset) {
            $('.wrapper .section').each(function(i) {
                // Current content block's position less body padding
                var current = $(this).offset().top - offset - 1;
                
                // Add active class to corresponding affix menu while removing the same from siblings as per position) of current block
                if (current <= position) {
                    $('a', $affixElement).eq(i).addClass('active').siblings().removeClass('active');
                }
            });
        } else {
            $('a', $affixElement).find('.active').removeClass('active').end().find(":first").addClass('active');
        }
    };

    $(window).on('scroll resize', function() {
        affix();
 
    });

</script>